% Compile with LuaLaTeX
\RequirePackage{luatex85}
\documentclass[a4paper,sfsidenotes,twoside,justified,nobib]{tufte-book-custom}
% \usepackage{showframe}

\hypersetup{colorlinks}

\title[Homomorphism Problems]{Homomorphism Problems\\in Graph Databases\\ and Automatic Structures}
\author{Rémi Morvan}


\setcounter{secnumdepth}{3}

% Dependencies
\input{header/colour-palette}
\input{header/dependencies}
\input{header/tikz}
\input{header/kl-config}
\input{header/theorems}

% Macros and math commands
\input{header/macros}
\input{header/math}
\input{header/math-database}
\input{header/math-automatic}

% Knowledge files
\input{kl/abbreviations.kl}
\input{kl/complexity.kl}
\input{kl/misc.kl}
\input{kl/structures.kl}
\input{kl/homomorphism.kl}
\input{kl/first-order.kl}
\input{kl/regular-languages.kl}
\input{kl/concrete-graphs.kl}
\input{kl/wikidata.kl}

% Knowledge files for graph databases

% Knowledge files for automatic structures
\input{kl/automatic-struct/duality.kl}
\input{kl/automatic-struct/automatic-structures.kl}
\input{kl/automatic-struct/decision-problems.kl}
\input{kl/automatic-struct/turing-machine.kl}
\input{kl/automatic-struct/relations.kl}
\input{kl/automatic-struct/monoids.kl}
\input{kl/automatic-struct/colouring.kl}
\input{kl/automatic-struct/misc.kl}
\input{kl/automatic-struct/algebra-profinite.kl}
\input{kl/automatic-struct/algebra-pseudovarieties.kl}
\input{kl/automatic-struct/algebra-relations.kl}
\input{kl/automatic-struct/algebra-semigroups.kl}
\input{kl/automatic-struct/algebra-synchronous-algebras.kl}
\input{kl/automatic-struct/algebra-types.kl}
\input{kl/automatic-struct/algebra-misc.kl}

% Biblio 

% Biblio
% \usepackage[
% 	style=alphabetic,
% 	citetracker=true,	
% 	citereset=chapter,
% 	backend=biber
% ]{biblatex}
% \addbibresource{bib-automatic-graphs}
% \addbibresource{bib-complexity}
\usepackage[
  style=alphabetic,
  autocite=footnote,
  maxalphanames=9,
  maxbibnames=99,
  backend=biber
]{biblatex}
\bibliography{bib-abbrev,bib-global,bib-automatic-graphs,bib-databases,bib-complexity}

\begin{document}

\frontmatter
\include{parts/titlepage}
\include{parts/copyright}
\include{parts/preface}
\include{parts/contents}

\mainmatter
% \chapter*{Abstract}
% \addcontentsline{toc}{chapter}{Abstract}

\chapter*{Résumé}
\addcontentsline{toc}{chapter}{Résumé}

\chapter*{Ideas/Todos}

\begin{itemize}
	\item \todo{Change definition of CQ/CRPQ to have vertices. This allows for better duality,
		and also better statement for the Semantical Structure Theorem (in some prop we get
		``foo is an edge contraction of bla'' instead of ``is a minor of'').
		Update the definition of `one-way internal path' to allow for $n=0$.}
	\item \todo{allow autocite in margin.}
		\todo{citation at wrong place in margin.}
		\todo{do NOT overwrite options for sidenote, etc.}
		See \texttt{tufte-book-custom.cls}.
	\item \todo{Add chapter number in outline (Diego)}
	\item \todo{Add Contents to outline.}
	\item \todo{Add subsections to outline.}
	\item \todo{replace all $\hdots$ (hdots) with $\dotsc$ (dotsc)}
	\item \todo{knowledgify the $\lBrack, r\rBrack$}
	\item \todo{What about having $\?B$ as part of the input? (for dichotomy theorem)}
	\item \todo{fix the proof env (``Proof (Proof sketch).'' -> ``Proof sketch.'')}
	\item \todo{add an `end of example' and `end of remark' symbol} 
	\item \todo{Diego finds $\Gamma_{\smallpad}$ strange}
	\item \todo{capitalize cref with proposition (see in \Cref{coro:finite-duality-implies-hom-equals-homreg})}
	\item \todo{fix $\nothomto$ arrows}
	\item \todo{Diego, biblio: ``some names have missing accents (esp polish), editors sometimes present sometimes not''}
	\item \todo{Same counter for Figure and Tables}
	\item \todo{We/I}
	\item \todo{daltoniens figure VII.8 \& VII.9 (rouge/vert)}
	\item \todo{Introduce $H^n_{\!\?A,\?B}$ notation for $\HCOperator^{\,n}_{\!\?A,\?B}(\topLatticeGuessFunctions{B})$.}
	\item \todo{fix $\nothomto$ and $\notcongr{\+R}$}
	\item \todo{explain the congruence in intro of ch-algebra (this is where the properties of the dependency relation comes from)}
	\item \todo{Increase distance between footnote and figure caption}
	\item \todo{maximal under-approximation: des fois avec hyphen, des fois sans}
\end{itemize}

At the end :
\begin{itemize}
	\item check APs 
	\item remove tags (\textsf{\\tag})
\end{itemize}

\include{parts/intro/ch-intro}

\include{parts/general-preliminaries/ch-general-preliminaries}

\part{Querying Graph Databases}
\label{part:databases}

\include{parts/preliminaries-graph-databases/ch-preliminaries-graph-databases}
\include{parts/minimization-CRPQ/ch-minimization-CRPQ}
\include{parts/semantic-tree-width-CRPQ/ch-semantic-tree-width-CRPQ}
\include{parts/conclu-databases/ch-conclu-databases}

\part[The Frontier of Decidability in Automatic Structures]{The Frontier of Decidability\\in Automatic Structures}
\label{part:automatic}

\include{parts/preliminaries-automatic-structures/ch-preliminaries-automatic-structures}
\include{parts/dichotomy-theorem/ch-dichotomy-theorem}
\include{parts/algebra/ch-algebra}
\include{parts/conclu-automatic/ch-conclu-automatic}

\backmatter
% \begin{fullwidth}
% 	\chapter*{Bibliography}
% 	\addcontentsline{toc}{chapter}{Bibliography}
% 	\setlength{\columnsep}{8mm}
% 	\begin{multicols}{2}
% 		\printbibliography[heading=none]
% 	\end{multicols}
% \end{fullwidth}
\chapter*{Bibliography}
\addcontentsline{toc}{chapter}{Bibliography}
\printbibliography[heading=none]

\end{document}

