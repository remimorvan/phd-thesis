\input{header/index-preprocess.tex}
% Compile with LuaLaTeX
\RequirePackage{luatex85}
\documentclass[a4paper,sfsidenotes,twoside,justified,nobib]{tufte-book-custom}
% \usepackage{showframe}

\hypersetup{colorlinks}

\title[Homomorphism Problems]{Homomorphism Problems\\in Graph Databases\\ and Automatic Structures}
\author{Rémi Morvan}


% Dependencies
\input{header/colour-palette}
\input{header/dependencies}
\input{header/tikz}
\input{header/kl-config}
\input{header/theorems}

% Macros and math commands
\input{header/macros}
\input{header/math}
\input{header/math-database}
\input{header/math-automatic}

% Knowledge files
\input{kl/abbreviations.kl}
\input{kl/complexity.kl}
\input{kl/misc.kl}
\input{kl/structures.kl}
\input{kl/homomorphism.kl}
\input{kl/first-order.kl}
\input{kl/regular-languages.kl}
\input{kl/concrete-graphs.kl}
\input{kl/wikidata.kl}

% Knowledge files for graph databases

% Knowledge files for automatic structures
\input{kl/automatic-struct/duality.kl}
\input{kl/automatic-struct/automatic-structures.kl}
\input{kl/automatic-struct/decision-problems.kl}
\input{kl/automatic-struct/turing-machine.kl}
\input{kl/automatic-struct/relations.kl}
\input{kl/automatic-struct/monoids.kl}
\input{kl/automatic-struct/colouring.kl}
\input{kl/automatic-struct/misc.kl}
\input{kl/automatic-struct/algebra-profinite.kl}
\input{kl/automatic-struct/algebra-pseudovarieties.kl}
\input{kl/automatic-struct/algebra-relations.kl}
\input{kl/automatic-struct/algebra-semigroups.kl}
\input{kl/automatic-struct/algebra-synchronous-algebras.kl}
\input{kl/automatic-struct/algebra-types.kl}
\input{kl/automatic-struct/algebra-misc.kl}

% Biblio 
\usepackage[
  style=alphabetic,
  autocite=footnote,
  maxalphanames=9,
  maxbibnames=99,
  backend=biber,
  backref=true
]{biblatex}
\bibliography{bib-abbrev,bib-global,bib-automatic-graphs,bib-databases,bib-complexity}
\input{header/bib-config.tex}

\makeindex

% Line numbering
\usepackage[displaymath, mathlines]{lineno}
\linenumbers
\preto{\chapter}{\resetlinenumber}

\begin{document}

\input{kl/extra-index.tex}

\frontmatter
\include{parts/titlepage}
\include{parts/copyright}
% Counter for figures includes chapter number ("P" for preface)
\renewcommand\thefigure{P.\arabic{figure}}
\include{parts/preface}
\include{parts/contents}

\mainmatter
% \chapter*{Abstract}
% \addcontentsline{toc}{chapter}{Abstract}

% Counter for figures includes chapter number ("R" for Résumé)
\renewcommand\thefigure{R.\arabic{figure}}
\chapter*{Résumé}
\addcontentsline{toc}{chapter}{Résumé}

\input{parts/todo.tex}

% Counter for figures includes chapter number
\renewcommand\thefigure{\thechapter.\arabic{figure}}

\include{parts/intro/ch-intro}
\include{parts/general-preliminaries/ch-general-preliminaries}

\part{Querying Graph Databases}
\label{part:databases}

\include{parts/preliminaries-graph-databases/ch-preliminaries-graph-databases}
\include{parts/minimization-CRPQ/ch-minimization-CRPQ}
\include{parts/semantic-tree-width-CRPQ/ch-semantic-tree-width-CRPQ}
\include{parts/conclu-databases/ch-conclu-databases}

\part[The Frontier of Decidability in Automatic Structures]{The Frontier of Decidability\\in Automatic Structures}
\label{part:automatic}

\include{parts/preliminaries-automatic-structures/ch-preliminaries-automatic-structures}
\include{parts/dichotomy-theorem/ch-dichotomy-theorem}
\include{parts/algebra/ch-algebra}
\include{parts/conclu-automatic/ch-conclu-automatic}

\nolinenumbers
\begin{fullwidth}
	\chapter*{Bibliography}
	\chaptermark{Bibliography}
	\markboth{Bibliography}{Bibliography}
	\addcontentsline{toc}{chapter}{Bibliography}
	\setlength{\columnsep}{8mm}
	\begin{multicols}{2}
		\printbibliography[heading=none]
	\end{multicols}
\end{fullwidth}

\printindex

\end{document}