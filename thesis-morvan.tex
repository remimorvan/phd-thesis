\RequirePackage{luatex85}
\documentclass[a4paper,sfsidenotes,twoside,justified,nobib]{tufte-book-custom}
% \usepackage{showframe}

\hypersetup{colorlinks}

\title[Homomorphism Problems]{Homomorphism Problems\\in Graph Databases\\ and Automatic Structures}
\author{Rémi Morvan}


\setcounter{secnumdepth}{3}

% Dependencies
\input{header/colour-palette}
\input{header/dependencies}
\input{header/tikz}
\input{header/kl-config}
\input{header/theorems}

% Macros and math commands
\input{header/macros}
\input{header/math}
\input{header/math-database}
\input{header/math-automatic}

% Knowledge files
\input{kl/abbreviations.kl}
\input{kl/complexity.kl}
\input{kl/misc.kl}
\input{kl/structures.kl}
\input{kl/homomorphism.kl}
\input{kl/first-order.kl}
\input{kl/regular-languages.kl}
\input{kl/concrete-graphs.kl}

% Knowledge files for graph databases

% Knowledge files for automatic structures
\input{kl/automatic-struct/duality.kl}
\input{kl/automatic-struct/automatic-structures.kl}
\input{kl/automatic-struct/decision-problems.kl}
\input{kl/automatic-struct/turing-machine.kl}
\input{kl/automatic-struct/relations.kl}
\input{kl/automatic-struct/monoids.kl}
\input{kl/automatic-struct/colouring.kl}
\input{kl/automatic-struct/misc.kl}

% Biblio 

% Biblio
% \usepackage[
% 	style=alphabetic,
% 	citetracker=true,	
% 	citereset=chapter,
% 	backend=biber
% ]{biblatex}
% \addbibresource{bib-automatic-graphs}
% \addbibresource{bib-complexity}
\usepackage[
  style=alphabetic,
  autocite=footnote,
  maxalphanames=9,
  maxbibnames=99,
  backend=biber
]{biblatex}
\bibliography{bib-abbrev,bib-automatic-graphs,bib-complexity}

\begin{document}

\frontmatter
\include{parts/titlepage}
\include{parts/copyright}
\include{parts/contents}

\mainmatter
\chapter*{Abstract}
\addcontentsline{toc}{chapter}{Abstract}

\chapter*{Résumé étendu}
\addcontentsline{toc}{chapter}{Résumé étendu}

\chapter*{Ideas/Todos}

\begin{itemize}
	\item \todo{Change definition of CQ/CRPQ to have vertices. This allows for better duality,
		and also better statement for the Semantical Structure Theorem (in some prop we get
		``foo is an edge contraction of bla'' instead of ``is a minor of'').
		Update the definition of `one-way internal path' to allow for $n=0$.}
	\item \todo{allow autocite in margin.}
		\todo{citation at wrong place in margin.}
		\todo{do NOT overwrite options for sidenote, etc.}
		See \texttt{tufte-book-custom.cls}.
	\item \todo{we assume that the reader is not rotating around a black-hole (affref)
	or able to travel at relativistic speeds (https://www.scottaaronson.com/democritus/lec19.html).}
	\item \todo{Add chapter number in outline (Diego)}
	\item \todo{replace all $\hdots$ (hdots) with $\dotsc$ (dotsc)}
	\item \todo{knowledgify the $\lBrack, r\rBrack$}
	\item \todo{What about having $\?B$ as part of the input? (for dichotomy theorem)}
	\item \todo{fix the proof env (``Proof (Proof sketch).'' -> ``Proof sketch.'')}
	\item \todo{add an end-of-example symbol}
	\item \todo{Diego finds $\Gamma_{\smallpad}$ strange}
	\item \todo{capitalize cref with proposition (see in \Cref{coro:finite-duality-implies-hom-equals-homreg})}
	\item \todo{fix $\homto$ arrows}
\end{itemize}

\include{parts/intro/ch-intro}

\include{parts/general-preliminaries/ch-general-preliminaries}

\part{Querying Graph Databases}

\include{parts/preliminaries-graph-databases/ch-preliminaries-graph-databases}

\chapter{Minimization of Conjunctive Regular Path Queries}

\chapter[{Semantic Tree-Width and Path-Width of Conjunctive Regular Path Queries}]{Semantic Tree-Width and Path-Width\\of Conjunctive Regular Path Queries}

% \chapter{Synthesis of Conjunctive Regular Path Queries}

\chapter{Conclusion \& Open Problems}

Extend the notion of `strong minimality` using the axioms used in the lower bound (`str-onto`): call such canonical databases / extensions `structurally minimal'.
Prove or disprove the following result: ``a CRPQ has one-way semantic tree-width at least $k$ "iff" it has an expansion that is structurally minimal and whose core has tree-width at least $k$''. In general: what about minor-closed classes?
Extend Grohe's Theorem to CRPQs (or maybe to a subclass of CRPQs, "eg" those whose
structurally minimal canonical databases characterize membership to minor-closed classes).

\part[The Frontier of Decidability in Automatic Structures]{The Frontier of Decidability\\in Automatic Structures}

\include{parts/preliminaries-automatic-structures/ch-preliminaries-automatic-structures}
\include{parts/dichotomy-theorem/ch-dichotomy-theorem}

\chapter[Relative Membership for Pseudovarieties of Regular Languages]{The Algebras for Automatic Relations and Beyond: \\the Relative Membership Problem for Pseudovarieties of Regular Languages}

\lipsum[1]
\begin{itemize}
	\item one
	\item two
	\item three
	\item spaghetti
\end{itemize}
\lipsum[1]

\begin{theorem}
	\lipsum[1]
\end{theorem}

\lipsum[1]

\begin{proof}
	\lipsum[1]
\end{proof}

\lipsum[1]

\lipsum[2]

\chapter{Conclusion \fancyand~Open Problems}

\backmatter
% \begin{fullwidth}
% 	\chapter*{Bibliography}
% 	\addcontentsline{toc}{chapter}{Bibliography}
% 	\setlength{\columnsep}{8mm}
% 	\begin{multicols}{2}
% 		\printbibliography[heading=none]
% 	\end{multicols}
% \end{fullwidth}
\chapter*{Bibliography}
\addcontentsline{toc}{chapter}{Bibliography}
\printbibliography[heading=none]

\end{document}

