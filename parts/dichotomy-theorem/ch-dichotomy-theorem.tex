\chapter{A Dichotomy Theorem for Automatic Structures}

Let \AP$\intro*\Fin$ denote the class of all "finite $\sigma$-structures",
\AP$\intro*\Aut$ the class of all "automatic $\sigma$-structures".
We let \AP$\intro*\AutPres$ be the class of all "automatic presentations of $\sigma$-structures",
and \AP$\intro*\FinPres$ be the subclass of "presentations" of "finite $\sigma$-structures".

Given a "$\sigma$-structure" $\?B$, and a class $\classStruct$ of "automatic presentations of $\sigma$-structures", we denote by \AP$\intro*\HomPb{\classStruct}{\?B}$ the class of all presentations $\•A \in \classStruct$ such that the "$\sigma$-structure" $\?A$
that they "represent" admits a "homomorphism" to $\?B$.
Similarly, we denote by \AP$\intro*\HomRegPb{\classStruct}{\?B}$ the class 
associated to "regular homomorphisms".%
\sidenote{Todo: set-theoretic bullshit. Not a set but it is if we fix an alphabet. Blabla.}

While the existence of a "homomorphism" from some "automatic presentation" of $\?A$ 
to a "finite $\sigma$-structure" $\?B$ only depends on $\?A$ and not the "presentation" itself,
this is not true for "regular homomorphism".
For a $\sigma$-structure $\?B$,
we use \AP$\intro*\HomFin{\?B}$, $\intro*\HomAut{\?B}$, $\intro*\HomRegFin{\?B}$
and $\intro*\HomRegAut{\?B}$ as shorthands for $\HomPb{\FinPres}{\?B}$, $\HomPb{\AutPres}{\?B}$,
$\HomRegPb{\FinPres}{\?B}$ and $\HomRegPb{\AutPres}{\?B}$, respectively.

Note that any "homomorphism" from an "automatic presentation" of a "finite structure"
to a "finite structure" is also "regular@@hom" and so $\HomFin{\?B} = \HomRegFin{\?B}$.\sidenote{Note also that membership in $\HomFin{-} = \HomRegFin{-}$ and in
$\HomAut{-}$ only depends on the "structure represented"
by the "automatic presentation", and not on the "presentation" itself.
This is not the case for $\HomRegAut{-}$. We use these definitions for two reasons: (1) for consistency with $\HomRegAut{-}$ and (2) for the associated decision problem to be defined unambiguously. Note moreover that in the case of "finite structures", the size of its representation, say using a adjacency lists, and of its "automatic presentation" are equal up to a TODO.}

\begin{theorem}[Dichotomy Theorem for Automatic Structures]
  \!\footnote{The equivalence between (1) and (2) still holds
  when the "homomorphism problem" takes as input ``higher-order automatic
  structures'' as defined in \cite[last remark of \S~XII.3]{Blumensath2024MSOModelTheory},
  since such structures have a decidable first-order theory.}%
  %%%
  \AP\label{thm:dichotomy-theorem-automatic-structures}
  Let $\?B$ be a "finite $\sigma$-structure". The following are equivalent:
  \begin{enumerate}
    \item $\?B$ has "finite duality";
    \item $\HomAut{\?B}$ is "decidable";
    \item $\HomRegAut{\?B}$ is "decidable";
    \item $\HomAut{\?B} = \HomRegAut{\?B}$ "ie" for any "automatic presentation" $\•A$ of a 
      "$\sigma$-structure" $\?A$, there is a "homomorphism" from $\?A$ to $\?B$ "iff" 
      there is a "regular homomorphism" from $\•A$ to $\?B$.
  \end{enumerate}
  Moreover, when $\HomAut{\?B}$ and $\HomRegAut{\?B}$ undecidable, they are "coRE"-complete
  and "RE"-complete, respectively. When they are decidable, they are "NL" and TODO, respectively.
\end{theorem}

\input{parts/dichotomy-theorem/sec-preliminaries}
\input{parts/dichotomy-theorem/sec-undecidability}


\cite{LaroseLotenTardif2007CharacterisationFOCSP}
\cite{LaroseTesson2009UniversalAlgebraCSP}