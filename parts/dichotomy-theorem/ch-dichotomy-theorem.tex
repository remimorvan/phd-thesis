\chapter{A Dichotomy Theorem for Automatic Structures}

\begin{abstract}
	\marginnote[1.3em]{
		TODO: Section X has been published in BLA.

		Part of the dichotomy theorem---Sections X and Y---was proven during the internship
		of Antoine Cuvelier that I supervised in Summer 2024.

		We thank Joanna Fijalkow for helpful discussions on constraint satisfaction problems.
	}%
	We study the separation problem of "synchronous relations", "aka" "automatic relations",
	by "recognizable relations"---namely finite unions of Cartesian products of "regular languages".
	We prove it to be computationally equivalent to the "finite regular colourability of synchronous graphs", that takes an "rational presentation" of a "graph" as input, and asks whether
	it admits a "regular colouring"---meaning that for each colour, the set of words representing the elements having this colour is a "regular language"---with finitely many colours.

	We first show that, if the number of colours is fixed to be any natural number $k \geq 2$, then
	this problem is undecidable. This implies the undecidability of the separation problem
	of "synchronous relations" by "recognizable relations" where the number of unions allowed is bounded.

	We then generalize this result, and prove a dichotomy theorem for automatic structures:
	for any "relational structure" $\?B$, the problem of whether an "automatic structure"
	admits a "homomorphism" to $\?B$ is either decidable in "NL", or is undecidable.
	We extend these results to "regular homomorphisms", for which we require the "homomorphisms"
	to be "regular@@hom", in the sense that every preimage of any element of the "target structure" $\?B$ must be a "regular language". In both cases, "structures" for which the problem is 
	decidable are those with ``"finite duality"''. 
	
	Using this dichotomy theorem, we then prove that the original problem, 
	namely the separation problem of "synchronous relations"
	by "recognizable relations" is undecidable.
\end{abstract}
\clearpage
\chaptertoc
\clearpage



Let \AP$\intro*\Fin$ denote the class of all "finite $\sigma$-structures",
\AP$\intro*\Aut$ the class of all "automatic $\sigma$-structures".
We let \AP$\intro*\AutPres$ be the class of all "rational presentations of $\sigma$-structures",
and \AP$\intro*\FinPres$ be the subclass of "presentations" of "finite $\sigma$-structures".

We denote by \AP$\intro*\HomFinClass{\?B}$ and $\intro*\HomAllClass{\?B}$ the class
of all finite (resp. all) "$\sigma$-structures" that admit a "homomorphism" to $\?B$.

Given a "$\sigma$-structure" $\?B$, and a class $\classStruct$ of "rational presentations of $\sigma$-structures", we denote by \AP$\intro*\HomDec{\classStruct}{\?B}$ the class of all presentations $\â€¢A \in \classStruct$ such that the "$\sigma$-structure" $\?A$
that they "represent@@structure" admits a "homomorphism" to $\?B$.
Similarly, we denote by \AP$\intro*\HomRegDec{\classStruct}{\?B}$ the class 
associated to "regular homomorphisms".%
\sidenote{Todo: set-theoretic bullshit. Not a set but it is if we fix an alphabet. Blabla.}

While the existence of a "homomorphism" from some "rational presentation" of $\?A$ 
to a "finite $\sigma$-structure" $\?B$ only depends on $\?A$ and not the "presentation" itself,
this is not true for "regular homomorphism".
For a $\sigma$-structure $\?B$,
we use \AP$\intro*\HomFinDec{\?B}$, $\intro*\HomAutDec{\?B}$, $\intro*\HomRegFinDec{\?B}$
and $\intro*\HomRegAutDec{\?B}$ as shorthands for $\HomDec{\FinPres}{\?B}$, $\HomDec{\AutPres}{\?B}$,
$\HomRegDec{\FinPres}{\?B}$ and $\HomRegDec{\AutPres}{\?B}$, respectively.

Note that any "homomorphism" from an "rational presentation" of a "finite structure"
to a "finite structure" is also "regular@@hom" and so $\HomFinDec{\?B} = \HomRegFinDec{\?B}$.\sidenote{Note also that membership in $\HomFinDec{-} = \HomRegFinDec{-}$ and in
$\HomAutDec{-}$ only depends on the "structure represented"
by the "rational presentation", and not on the "presentation" itself.
This is not the case for $\HomRegAutDec{-}$. We use these definitions for two reasons: (1) for consistency with $\HomRegAutDec{-}$ and (2) for the associated decision problem to be defined unambiguously. Note moreover that in the case of "finite structures", the size of its representation, say using adjacency lists, and of its "rational presentation" are equal up to a TODO}

\input{parts/dichotomy-theorem/sec-introduction}
\input{parts/dichotomy-theorem/sec-preliminaries}
\input{parts/dichotomy-theorem/sec-colouring}
\input{parts/dichotomy-theorem/sec-undecidability}
\input{parts/dichotomy-theorem/sec-decidability}
\input{parts/dichotomy-theorem/sec-discussion}
