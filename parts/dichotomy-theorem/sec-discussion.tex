\section{Discussion}
\AP\label{sec:dichotomy-discussion}

\subsection{Undecidability of Finite Regular Colourability}
\AP\label{sec:undecidability-finite-colourability}

First and foremost, our original problem, namely the "$\AUT$/$\REC$-separability problem",
or equivalently by \Cref{thm:reg-colourability-equiv-separability}, the "finite regular colourability problem", remains open. 

\begin{conjecture}%
	\!\footnote{The upper bound is trivial: given a "automatic graph" $\+G$,
	we guess some $k\in \N$ and check if $\+G \in \HomRegAutDec{\clique{k}}$, which is "RE"
	by \Cref{prop:dichotomy-general-upper-bounds}.}
	\AP\label{conj:finite-regular-colourability-undecidable}
	"finite regular colourability of automatic graphs" is "RE"-complete.
\end{conjecture}

We briefly explain here why the techniques developed in this chapter,
can not immediately solve this problem. 

We define \AP$\intro*\omegaClique$ to be the "disjoint union" $\bigoplus_{k\in\N} \clique{2^k}$ of all finite "cliques". Note that it is "homomorphically equivalent" to $\bigoplus_{k\in\N} \clique{k}$.
Moreover, it admits a simple "automatic presentation" \AP$\intro*\omegaCliquePres$: take the binary alphabet $\Sigma \defeq \{0,1\}$ and let%
\footnote{In this presentation, words of length $k$ are used to encode $\clique{2^k}$.}
\begin{align*}
	\domainPres{\omegaCliquePres} & \defeq \Sigma^*, \\ 
	\relPres{\+E}{\omegaCliquePres} & \defeq \{\tup{u,v} \in \Sigma^* \times \Sigma^* \mid |u| = |v| \text{ and }
	u \neq v\}.
\end{align*}

While there is some "graph" $\+G$ does not admit a "homomorphism" to $\omegaClique$, then it is not "finitely colourable", the converse implication does not hold---"eg" $\omegaClique$ itself is not "finitely colourable". However, the equivalence holds for a substantially large class of graphs.

\begin{property}
	\AP\label{prop:finite-regular-colourability-as-homreg-pb}
	Let $\?G$ be an arbitrary "connected" "graph". $\?G \homto \omegaClique$ "iff" $\?G$ is "finitely colourable".	
	Similarly, let $\•G$ be a "connected" "automatic graph". $\•G \homregto \omegaCliquePres$ "iff" $\?G$ is "finitely regularly colourable".
\end{property}

\begin{proof}
	A "homomorphism" must send pairs of "connected" vertices to pairs of "connected" vertices.
\end{proof}

\begin{proposition}
	\AP\label{prop:finite-colourability-of-connected-graphs}
	The "finite regular colourability problem" and its restriction to "connected" "automatic graphs"
	are "computationally equivalent".
\end{proposition}

\begin{proof}
	The reduction from the restricted to the general problem is straightforward.
	For the converse one, we add a new element $*$ to the "structure" $\+A$,\footnote{In particular, we extend the alphabet of the "presentation@@automatic".} and put an edge
	from $*$ to any element $u$ of the original "structure". 
	Clearly, the original structure is "finitely regularly colourable" "iff" the new one is---one direction is trivial, for the other one it suffices to assign to $*$ a new colour.
\end{proof}

Putting \Cref{prop:finite-regular-colourability-as-homreg-pb,prop:finite-colourability-of-connected-graphs} together, we obtain the following corollary.
\begin{corollary}
	The "finite regular colourability problem" and the restriction
	of $\HomRegAutDec{\omegaCliquePres}$ to "connected graphs" are "computationally equivalent".
\end{corollary}

On the other hand, we strongly believe that the proof of \Cref{lem:reduction-hom-reg} can be adapted
to obtain a lower bound on $\HomRegAutDec{\marked{\omegaCliquePres}}$.
\begin{conjecture}
	There is a reduction from "regular unconnectivity in automatic graphs" to
	$\HomRegAutDec{\marked{\omegaCliquePres}}$.
\end{conjecture}
Note however that \Cref{lem:reduction-hom-reg} does not directly apply since the "target structure"
is not finite---a fact that we use throughout the proof of \Cref{lem:reduction-hom-reg}.

Putting these last two statements together, to prove the "RE"-hardness of 
"finite regular colourability of automatic graphs", it would ``suffice'' to
build the following reduction.
\begin{conjecture}
	There is a reduction from $\HomRegAutDec{\marked{\omegaCliquePres}}$
	to the restriction of $\HomRegAutDec{\omegaCliquePres}$ to "connected graphs".
\end{conjecture}

This question seems however quite challenging. Note first that the reduction from 
"regular unconnectivity in automatic graphs" to $\HomRegAutDec{\marked{\omegaCliquePres}}$
heavily uses the fact that the "input structure" can be "unconnected@@struct".
Moreover, beyond this issue of "connectivity@@struct",
whether $\HomRegAutDec{\marked{\omegaCliquePres}}$ and $\HomRegAutDec{\omegaCliquePres}$
are equivalent is also not straightforward: note in particular that \Cref{prop:idempotent-core-preserves-csp-complexity} does not apply: not only $\omegaClique$ is not
finite, but more importantly it is not a "core".%
\footnote{Indeed, $\bigoplus_{k\in\N} \clique{k}$ is "homomorphically equivalent" to
$\bigoplus_{k\in I} \clique{k}$ for any infinite subset $I$ of $\N$.}

Similarly, we do not know whether "finite colourability problem" is undecidable.
\begin{conjecture}
	\!\footnote{Note again that the upper-bound is trivial, since by "De Bruijn-Erdős theorem",
	this problem is equivalent to asking if there exists $k\in \N$ "st"
	every "finite subgraph" of the "input@@struct" is "$k$-colourable".}
	\AP\label{conj:finite-colourability-undecidable}
	"Finite colourability of automatic graphs" is "Sigma0-2"-complete.
\end{conjecture}


\subsection{Invariance under Graph Isomorphisms}

Note that given an "automatic presentation" $\•A$ of some "$\sigma$-structure" $\?A$,
the property of whether $\•A \homregto \?B$, where $\?B$ is a "finite $\sigma$-structure",
does not depend only on the "structure" $\?A$, but on its "presentation" $\•A$---see \Cref{ex:tree-not-2-reg-colourable} for an example; it is trivial to come up with a "presentation" of the
same "graph" that admits a "regular $2$-colouring".

On the other hand, the implication
\itemDTFinDual\ $\Rightarrow$ \itemDTEqual\ prove that if $\?B$ has "finite duality",
then the property of whether $\•A \homregto \?B$ is invariant under "graph isomorphisms",
in the sense that for any "presentations" $\•A_1$ and $\•A_2$ of the "structures"
$\?A_1$ and $\?A_2$, respectively, if $\?A_1$ and $\?A_2$ are "isomorphic", then
$\•A_1 \homregto \?B$ "iff" $\•A_2 \homregto \?B$.
We do not know whether the converse implication holds.

\begin{conjecture}
	\AP\label{conj:invariance-under-graph-isomorphisms}
	For any "finite $\sigma$-structure" $\?B$, $\HomRegAutDec{\?B}$ is invariant
	under "graph isomorphisms" "iff" $\?B$ has "finite duality".
\end{conjecture}

\subsection{Obstacles to Finite Colourability}

Given that we do not know whether "finite colourability of automatic graphs"
is decidable, a natural question would be find algorithm to identify sufficient conditions
for a "graph" not to be "finitely colourable". A typical example of such a condition
is to \AP""contain unbounded cliques""---meaning that $\clique{k} \homto \?A$ for all $k\in\N$.

\begin{conjecture}
	\!\footnote{This conjecture corresponds to \cite[Conjecture 7.3]{BarceloFigueiraMorvan2023SeparatingAutomatic}.}
	\AP\label{conj:unbounded-cliques}
    The problem of whether an "automatic graph" "has bounded cliques" is decidable.
\end{conjecture}

In \cite[Conjecture 7.2]{BarceloFigueiraMorvan2023SeparatingAutomatic}, we conjectured
that there was some "automatic graphs" that were not "finite colourable",
but did not "contain unbounded cliques".
We pointed out that for arbitrary "graphs", the property was clearly true 
since there are \AP""triangle-free graphs@@dir""%
\footnote{Meaning that $\clique{3} \nothomto \?G$.}
$\?G$ that are not finitely colourable \cite{UngarDescartes1954ChromaticGraphs}.
However, we believe(d) that the infinite graph built using Ungar-Descartes' technique
is not "automatic".
Since then, we managed to prove this conjecture, by relying on another classical construction of
triangle-free graphs with arbitrary large "chromatic number".

\begin{proposition}
	\AP\label{prop:automatic-graph-not-fin-colourable}
	There exists a "triangle-free@@dir" "automatic graph" that is not "finitely colourable".
\end{proposition}

Mycielski's construction is an operator $\Myc$ on undirected graphs,
introduced in \cite{Mycielski55Coloriage}, with the property that if $G$ is \AP""triangle-free@@undir""%
\footnote{Unsurprisingly, for undirected graphs, ``"triangle-free@@undir"'' means that there are no
three vertices that are pairwise adjacent.},
then so is $\Myc(G)$, and moreover
the "chromatic number" of $\Myc(G)$ is exactly one more than the "chromatic number" of $G$.
Iterating this operator on a "triangle-free graph@@undir" shows that there exists
"triangle-free graphs@@undir" with arbitrarily high "chromatic number".
To prove \Cref{prop:automatic-graph-not-fin-colourable}, we will build
an "automatic graph" whose underlying undirected graph is
$\bigdcup_{n\in\N} \Myc^n(H)$ where $H$ is the "graph" on a single vertex with no edge.
Note that usually Mycielski's construction is not iterated on $H$ but on "the"
path of size 1: we made this choice to make the proof of "automaticity" of the graph
easier.

\begin{definition}
	Given an undirected graph $G = \langle V, \+E \rangle$, let
	\AP$\intro*\Myc(G)$ be the undirected graph whose set of vertices is
	$V\times\{0,1\} \dcup \{\bullet\}$, with the following edges:
	\begin{itemize}
		\item $\{\langle u, 0 \rangle,\, \langle v, 0 \rangle\}$
			for every edge $\{ u,v \} \in \+E$,
		\item $\{\langle u, 0 \rangle,\, \langle v, 1 \rangle\}$
			for every edge $\{ u,v \} \in \+E$, and
		\item $\{ \bullet,\, \langle v, 1 \rangle\}$
			for every $v \in \+E$.
	\end{itemize}
\end{definition}

Note that $u \mapsto \langle u,0\rangle$ always defines an embedding of
$G$ into $\Myc(G)$.

\begin{property}
	\label{prop:triangle-free}
	If $G$ is "triangle-free@@undir", then so is $\Myc(G)$.
\end{property}

\begin{proof}
	All neighbours of $\bullet$ are of the form $\langle -, 1\rangle$,
	and two vertices of the form $\langle -, 1\rangle$ are never adjacent.
	Hence, any potential triangle in $\Myc$ must be of the form
	\[
	\{
		\langle u, 0 \rangle,\,
		\langle v, 0 \rangle,\,
		\langle w, 0 \rangle
	\}
	\quad\text{or}\quad
	\{
		\langle u, 0 \rangle,\,
		\langle v, 1 \rangle,\,
		\langle w, 0 \rangle
	\}.
	\]
	In both cases, this would imply that $\{u,v,w\}$ is a triangle in $G$:
	contradiction.
\end{proof}

\begin{figure}
	\centering
	\begin{tikzpicture}
		\input{tikz/dichotomy/mycielski}
	\end{tikzpicture}
	\caption{
		\AP\label{fig:Mycielski}
		The undirected path of length 1,
		and two iterations of Mycielski's construction $\Myc$ on this graph.
		Each of these graphs is equipped with a $2$-, $3$-, and $4$-colouring, respectively, 
		which are built using the construction described in the proof
		of \Cref{prop:chromatic-number}.
	}
\end{figure}

\begin{property}
	\label{prop:chromatic-number}
	The "chromatic number" of $\Myc(G)$
	is exactly one more than the "chromatic number" of $G$.
\end{property}

\begin{proof}
  \proofcase{Upper bound.}
  Let $f\colon G \to \lBrack 1,k \rBrack$ be a "colouring" of $G$ for some $k\in \N$.
  Then mapping $\langle u, i \rangle$ to $f(u)$ for $u \in G$ and $i \in \{0,1\}$
  and mapping $\bullet$ to colour $k+1$ defines a "$(k+1)$-colouring" of $\Myc(G)$.

  \proofcase{Lower bound.}
  Let $k \in \Np$ and let $g\colon \Myc(G) \to \lBrack 1,k\rBrack$ be a
  $k$-colouring of $\Myc(G)$.
  Let $g'\colon \Myc(G) \to \lBrack 1,k\rBrack$
  be defined by $g'\langle u,i\rangle \defeq g\langle u,1 \rangle$,
  and $g'(\bullet) \defeq g(\bullet)$.
  Since the neighbourhood of $\langle u,0 \rangle$ is included in the
  one of $\langle u,1 \rangle$, it follows that $g'$ is still a "$k$-colouring"
  of $\Myc(G)$. But then $\bullet$ is adjacent to all vertices of the form $\langle u, 1\rangle$
  where $u\in G$, so $\{g'\langle u, 1\rangle \mid u \in G\}$ can only contain at most $k-1$ colours.
  By construction of $g'$, $g'\langle u, 1\rangle = g'\langle u, 0\rangle$.
  And hence $u \mapsto g' \langle u,0 \rangle$ defines a "$(k-1)$-colouring" of $G$.
\end{proof}

We can now prove our result.

\begin{proof}[Proof of \Cref{prop:automatic-graph-not-fin-colourable}]
  Let $\Sigma \defeq \{0,1,\bullet\}$, and let $H$ be the "directed
  graph" on a single vertex with no edge.
  We are going to define an "automatic graph" whose underlying undirected graph
  is $\bigdcup_{n\in\N} \Myc^n(H)$, in such a way that the vertices of $\Myc^n(H)$
  will be encoded by words of length $n$.

  We are going to define by induction
  disjoint subsets $(V_i)_{i\in\N}$ of $\Sigma^*$
  and $(\+E_i)_{i\in\N}$ of $V_i \times V_i$ such that
  $(V_i, \+E_i)$ is a directed version of $\Myc^n(H)$.

  Define $V_0 \defeq \{\varepsilon\}$ and $\+E_0 \defeq \emptyset$.
  Then for $n \in \N$, let
  \begin{align*}
    V_{n+1} & \defeq \{u0\mid u \in V_n\}\cup \{u1\mid u \in V_n\}\cup\{\bullet^{n+1}\}\\
    \+E_{n+1} & \defeq \{\langle u0,v0\rangle \mid \langle u,v\rangle \in \+E_n\}
		\cup \{\langle v0,u0\rangle \mid \langle u,v\rangle \in \+E_n\} \\
		& \cup \{\langle u0,v1\rangle \mid \langle u,v\rangle \in \+E_n\}
		\cup \{\langle v1,u0\rangle \mid \langle u,v\rangle \in \+E_n\} \\
    	& \cup \{\langle u1, \bullet^{n+1}\rangle \mid u\in V_n\}
		\cup \{\langle \bullet^{n+1}, u1\rangle \mid u\in V_n\}.
  \end{align*}
  Then let \AP$\intro*\MycInf \defeq \tup{V, \+E}$ be
  the ""infinite Mycielski graph"" where $V \defeq \bigcup_{n\in \N} V_n$
  and $E \defeq \bigcup_{n\in \N} E_n$.
  By construction, each $\+E_n$ is "symmetric@@rel",%
  \footnote{In fact some of the sets defining $\+E_{n+1}$ are redundant because of these,
  but we keep them in the definition to emphasize this symmetry.}
  and moreover $V_n \subseteq \Sigma^n$ by immediate induction on $n\in\N$.

  Also, the underlying undirected graph of $\MycInf$ is
  $\bigdcup_{n\in\N} \Myc^n(H)$, and so it is "triangle-free@@dir" (since $H$ is "triangle-free@@undir") by \Cref{prop:triangle-free} but has infinite
  "chromatic number" by \Cref{prop:chromatic-number}. 
  
  It remains to show that $\MycInf$ is "automatic@@graph".
  First, notice that $V = \bullet^*(0+1)^*$ since by trivial induction
  on $n\in\N$ we have $V_n = (\bullet^*(0+1)^*)\cap \Sigma^n$. And hence,
  $V$ is "regular@@lang".

  Now we claim that there is an edge from $u \in V$ to $v \in V$ if and only if
  \begin{itemize}
    \item $u$ and $v$ have the same length,
    \item $u$ contains at least one $\bullet$
      and letting $i$ be the index of the last occurrence of $\bullet$ in $u$,
      we have $v_i = 1$, and
    \item for all $j \in \lBrack i+1,n\rBrack$, $u_j = 0$
    and $v_j \in \{0,1\}$.
  \end{itemize}
  Call the property above $\+P$.
  To prove it, observe first that $\+E$ contains no edge
  between vertices of distinct length, and then we prove
  by induction on $n\in\N$ that $\+E_n = \{\langle u,v\rangle \in V_n \mid (u,v) \models \+P\}$.
  For $n=0$ the result is trivial, and if it holds at rank $n\in\N$,
  then it is clear that $\+E_{n+1} \subseteq
  \{\langle u,v\rangle \in V_{n+1} \mid (u,v) \models \+P\}$.
  Conversely, if $u,v \in V_{n+1}$ satisfies $\+P$, then
  either:
  \begin{itemize}
    \item the last letter of $u$ is $\bullet$ and so $v$ ends with a
    1, and thus $\langle u,v \rangle \in \{\langle \bullet^{n+1}, v'1\rangle \mid v'\in V_n\}
    \subseteq \+E_{n+1}$, or 
    \item the last letter of $u$ is $0$, and the last letter of $v$ is $0$ or $1$;
      letting $u = u'0$ and $v = v'a$ with $a \in \{0,1\}$, we have
      that $\langle u', v'\rangle$ satisfy $\+P$, so by induction hypothesis,
      $\langle u', v'\rangle \in \+E_n$ and hence
      \[\langle u,v \rangle \in \{\langle u'0,v'0\rangle \mid \langle u',v'\rangle \in \+E_n\}
      \cup \{\langle u'0,v'1\rangle \mid \langle u',v'\rangle \in E_n\} \subseteq \+E_{n+1}.\]
  \end{itemize}
  In all cases, $\langle u,v\rangle \in \+E_{n+1}$ which concludes the induction.
  To conclude, it suffices to notice that the condition $\+P$ is clearly "automatic".
\end{proof}